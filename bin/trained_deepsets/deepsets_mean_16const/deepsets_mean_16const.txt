[96m
GPU: NVIDIA GeForce GTX 1080 Ti[0m
[92mSaved hyperparameters to json file.[0m
[95m
DATA DEETS[0m
[95m-----------[0m
data_folder: /work/deodagiu/ki_data/intnet_input
norm: nonorm
train_events: -1
test_events: 0
pt_min: 2.0
nconstituents: 16
feature_selection: jedinet
flag: 

----------------
[92mData loading complete:[0m
Training data size: 5.72e+05
Test data size: 0.00e+00
----------------

Shuffling constituents...
[92mShuffled the training data! 🃏
[0m
Instantiating model with the hyperparameters:
nnodes: 32
[92mModel compiled and built![0m
Model: "DeepSets"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 sequential (Sequential)     (None, 16, 32)            5216      
|¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯|
| permutation_equivariant_mea  (None, 16, 32)         1056      |
| n (PermutationEquivariantMe                                   |
| an)                                                           |
|                                                               |
| activation (Activation)   (None, 16, 32)            0         |
|                                                               |
| permutation_equivariant_mea  (None, 16, 32)         2080      |
| n_1 (PermutationEquivariant                                   |
| Mean)                                                         |
|                                                               |
| activation_1 (Activation)  (None, 16, 32)           0         |
|                                                               |
| permutation_equivariant_mea  (None, 16, 32)         2080      |
| n_2 (PermutationEquivariant                                   |
| Mean)                                                         |
|                                                               |
| activation_2 (Activation)  (None, 16, 32)           0         |
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
 sequential_1 (Sequential)   (None, 5)                 613       
|¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯|
| dense_6 (Dense)           (None, 16)                528       |
|                                                               |
| dense_7 (Dense)           (None, 5)                 85        |
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
=================================================================
Total params: 5,829
Trainable params: 5,829
Non-trainable params: 0
_________________________________________________________________
[95m

TRAINING THE MODEL 💪[0m

Training parameters
-------------------
[92mOptimiser: 	[0m {'name': 'Adam', 'learning_rate': 0.001, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92mBatch size: 	[0m 128
[92mLearning rate: 	[0m 0.001
[92mTraining epochs:[0m 70
[92mLoss: 		[0m <keras.losses.CategoricalCrossentropy object at 0x7faa83c0ece0>

Epoch 1/70
3127/3127 - 15s - loss: 1.4791 - categorical_accuracy: 0.3727 - val_loss: 1.2464 - val_categorical_accuracy: 0.4819 - lr: 0.0010 - 15s/epoch - 5ms/step
Epoch 2/70
3127/3127 - 13s - loss: 1.1612 - categorical_accuracy: 0.5253 - val_loss: 1.1335 - val_categorical_accuracy: 0.5350 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 3/70
3127/3127 - 13s - loss: 1.0903 - categorical_accuracy: 0.5587 - val_loss: 1.0446 - val_categorical_accuracy: 0.5829 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 4/70
3127/3127 - 13s - loss: 1.0524 - categorical_accuracy: 0.5775 - val_loss: 1.0440 - val_categorical_accuracy: 0.5777 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 5/70
3127/3127 - 13s - loss: 1.0311 - categorical_accuracy: 0.5869 - val_loss: 1.0046 - val_categorical_accuracy: 0.6037 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 6/70
3127/3127 - 13s - loss: 1.0159 - categorical_accuracy: 0.5945 - val_loss: 0.9876 - val_categorical_accuracy: 0.6075 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 7/70
3127/3127 - 13s - loss: 1.0027 - categorical_accuracy: 0.6005 - val_loss: 0.9703 - val_categorical_accuracy: 0.6186 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 8/70
3127/3127 - 13s - loss: 0.9891 - categorical_accuracy: 0.6071 - val_loss: 0.9820 - val_categorical_accuracy: 0.6126 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 9/70
3127/3127 - 13s - loss: 0.9770 - categorical_accuracy: 0.6141 - val_loss: 0.9615 - val_categorical_accuracy: 0.6198 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 10/70
3127/3127 - 13s - loss: 0.9631 - categorical_accuracy: 0.6234 - val_loss: 0.9542 - val_categorical_accuracy: 0.6254 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 11/70
3127/3127 - 13s - loss: 0.9465 - categorical_accuracy: 0.6348 - val_loss: 0.9463 - val_categorical_accuracy: 0.6326 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 12/70
3127/3127 - 13s - loss: 0.9269 - categorical_accuracy: 0.6460 - val_loss: 0.9149 - val_categorical_accuracy: 0.6532 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 13/70
3127/3127 - 13s - loss: 0.9170 - categorical_accuracy: 0.6514 - val_loss: 0.9159 - val_categorical_accuracy: 0.6488 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 14/70
3127/3127 - 13s - loss: 0.9089 - categorical_accuracy: 0.6554 - val_loss: 0.8956 - val_categorical_accuracy: 0.6607 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 15/70
3127/3127 - 13s - loss: 0.9019 - categorical_accuracy: 0.6586 - val_loss: 0.8962 - val_categorical_accuracy: 0.6601 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 16/70
3127/3127 - 13s - loss: 0.8950 - categorical_accuracy: 0.6617 - val_loss: 0.8820 - val_categorical_accuracy: 0.6677 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 17/70
3127/3127 - 13s - loss: 0.8895 - categorical_accuracy: 0.6643 - val_loss: 0.8979 - val_categorical_accuracy: 0.6568 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 18/70
3127/3127 - 13s - loss: 0.8852 - categorical_accuracy: 0.6662 - val_loss: 0.8934 - val_categorical_accuracy: 0.6596 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 19/70
3127/3127 - 13s - loss: 0.8798 - categorical_accuracy: 0.6690 - val_loss: 0.8774 - val_categorical_accuracy: 0.6704 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 20/70
3127/3127 - 13s - loss: 0.8762 - categorical_accuracy: 0.6702 - val_loss: 0.8717 - val_categorical_accuracy: 0.6716 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 21/70
3127/3127 - 13s - loss: 0.8719 - categorical_accuracy: 0.6727 - val_loss: 0.9354 - val_categorical_accuracy: 0.6387 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 22/70
3127/3127 - 13s - loss: 0.8682 - categorical_accuracy: 0.6745 - val_loss: 0.8458 - val_categorical_accuracy: 0.6878 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 23/70
3127/3127 - 13s - loss: 0.8633 - categorical_accuracy: 0.6762 - val_loss: 0.8548 - val_categorical_accuracy: 0.6809 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 24/70
3127/3127 - 13s - loss: 0.8593 - categorical_accuracy: 0.6783 - val_loss: 0.8380 - val_categorical_accuracy: 0.6899 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 25/70
3127/3127 - 13s - loss: 0.8579 - categorical_accuracy: 0.6787 - val_loss: 0.8496 - val_categorical_accuracy: 0.6840 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 26/70
3127/3127 - 13s - loss: 0.8531 - categorical_accuracy: 0.6815 - val_loss: 0.8452 - val_categorical_accuracy: 0.6842 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 27/70
3127/3127 - 13s - loss: 0.8496 - categorical_accuracy: 0.6829 - val_loss: 0.8309 - val_categorical_accuracy: 0.6918 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 28/70
3127/3127 - 13s - loss: 0.8449 - categorical_accuracy: 0.6854 - val_loss: 0.8310 - val_categorical_accuracy: 0.6933 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 29/70
3127/3127 - 13s - loss: 0.8439 - categorical_accuracy: 0.6851 - val_loss: 0.8472 - val_categorical_accuracy: 0.6824 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 30/70
3127/3127 - 13s - loss: 0.8410 - categorical_accuracy: 0.6863 - val_loss: 0.8638 - val_categorical_accuracy: 0.6750 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 31/70
3127/3127 - 13s - loss: 0.8350 - categorical_accuracy: 0.6894 - val_loss: 0.8371 - val_categorical_accuracy: 0.6853 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 32/70
3127/3127 - 13s - loss: 0.8327 - categorical_accuracy: 0.6908 - val_loss: 0.8709 - val_categorical_accuracy: 0.6712 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 33/70
3127/3127 - 13s - loss: 0.8315 - categorical_accuracy: 0.6910 - val_loss: 0.8142 - val_categorical_accuracy: 0.7004 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 34/70
3127/3127 - 13s - loss: 0.8276 - categorical_accuracy: 0.6928 - val_loss: 0.8167 - val_categorical_accuracy: 0.6993 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 35/70
3127/3127 - 13s - loss: 0.8247 - categorical_accuracy: 0.6943 - val_loss: 0.8167 - val_categorical_accuracy: 0.6959 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 36/70
3127/3127 - 13s - loss: 0.8214 - categorical_accuracy: 0.6951 - val_loss: 0.8350 - val_categorical_accuracy: 0.6870 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 37/70
3127/3127 - 13s - loss: 0.8195 - categorical_accuracy: 0.6964 - val_loss: 0.8356 - val_categorical_accuracy: 0.6866 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 38/70
3127/3127 - 13s - loss: 0.8167 - categorical_accuracy: 0.6980 - val_loss: 0.8000 - val_categorical_accuracy: 0.7068 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 39/70
3127/3127 - 13s - loss: 0.8129 - categorical_accuracy: 0.7004 - val_loss: 0.8059 - val_categorical_accuracy: 0.7055 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 40/70
3127/3127 - 13s - loss: 0.8101 - categorical_accuracy: 0.7013 - val_loss: 0.8019 - val_categorical_accuracy: 0.7042 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 41/70
3127/3127 - 13s - loss: 0.8043 - categorical_accuracy: 0.7036 - val_loss: 0.8161 - val_categorical_accuracy: 0.6969 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 42/70
3127/3127 - 13s - loss: 0.7984 - categorical_accuracy: 0.7066 - val_loss: 0.8274 - val_categorical_accuracy: 0.6922 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 43/70
3127/3127 - 13s - loss: 0.7955 - categorical_accuracy: 0.7084 - val_loss: 0.7841 - val_categorical_accuracy: 0.7131 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 44/70
3127/3127 - 13s - loss: 0.7899 - categorical_accuracy: 0.7107 - val_loss: 0.7952 - val_categorical_accuracy: 0.7074 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 45/70
3127/3127 - 13s - loss: 0.7825 - categorical_accuracy: 0.7142 - val_loss: 0.7970 - val_categorical_accuracy: 0.7081 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 46/70
3127/3127 - 13s - loss: 0.7744 - categorical_accuracy: 0.7174 - val_loss: 0.7634 - val_categorical_accuracy: 0.7213 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 47/70
3127/3127 - 13s - loss: 0.7720 - categorical_accuracy: 0.7185 - val_loss: 0.7681 - val_categorical_accuracy: 0.7192 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 48/70
3127/3127 - 13s - loss: 0.7677 - categorical_accuracy: 0.7201 - val_loss: 0.7549 - val_categorical_accuracy: 0.7240 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 49/70
3127/3127 - 13s - loss: 0.7623 - categorical_accuracy: 0.7230 - val_loss: 0.7365 - val_categorical_accuracy: 0.7347 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 50/70
3127/3127 - 13s - loss: 0.7598 - categorical_accuracy: 0.7237 - val_loss: 0.7931 - val_categorical_accuracy: 0.7070 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 51/70
3127/3127 - 13s - loss: 0.7546 - categorical_accuracy: 0.7270 - val_loss: 0.7556 - val_categorical_accuracy: 0.7278 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 52/70
3127/3127 - 13s - loss: 0.7527 - categorical_accuracy: 0.7275 - val_loss: 0.7324 - val_categorical_accuracy: 0.7352 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 53/70
3127/3127 - 13s - loss: 0.7471 - categorical_accuracy: 0.7300 - val_loss: 0.7669 - val_categorical_accuracy: 0.7206 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 54/70
3127/3127 - 13s - loss: 0.7464 - categorical_accuracy: 0.7301 - val_loss: 0.7634 - val_categorical_accuracy: 0.7215 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 55/70
3127/3127 - 13s - loss: 0.7466 - categorical_accuracy: 0.7301 - val_loss: 0.7468 - val_categorical_accuracy: 0.7291 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 56/70
3127/3127 - 13s - loss: 0.7433 - categorical_accuracy: 0.7318 - val_loss: 0.7163 - val_categorical_accuracy: 0.7460 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 57/70
3127/3127 - 13s - loss: 0.7402 - categorical_accuracy: 0.7331 - val_loss: 0.7188 - val_categorical_accuracy: 0.7441 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 58/70
3127/3127 - 13s - loss: 0.7362 - categorical_accuracy: 0.7353 - val_loss: 0.7390 - val_categorical_accuracy: 0.7327 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 59/70
3127/3127 - 13s - loss: 0.7350 - categorical_accuracy: 0.7359 - val_loss: 0.7192 - val_categorical_accuracy: 0.7423 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 60/70
3127/3127 - 13s - loss: 0.7339 - categorical_accuracy: 0.7357 - val_loss: 0.7777 - val_categorical_accuracy: 0.7195 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 61/70
3127/3127 - 13s - loss: 0.7332 - categorical_accuracy: 0.7361 - val_loss: 0.7684 - val_categorical_accuracy: 0.7219 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 62/70
3127/3127 - 13s - loss: 0.7300 - categorical_accuracy: 0.7378 - val_loss: 0.7360 - val_categorical_accuracy: 0.7328 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 63/70
3127/3127 - 13s - loss: 0.7295 - categorical_accuracy: 0.7379 - val_loss: 0.7213 - val_categorical_accuracy: 0.7412 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 64/70
3127/3127 - 13s - loss: 0.7276 - categorical_accuracy: 0.7389 - val_loss: 0.7131 - val_categorical_accuracy: 0.7444 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 65/70
3127/3127 - 13s - loss: 0.7265 - categorical_accuracy: 0.7391 - val_loss: 0.7407 - val_categorical_accuracy: 0.7308 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 66/70
3127/3127 - 13s - loss: 0.7246 - categorical_accuracy: 0.7400 - val_loss: 0.7806 - val_categorical_accuracy: 0.7118 - lr: 0.0010 - 13s/epoch - 4ms/step
Epoch 67/70
3127/3127 - 13s - loss: 0.7113 - categorical_accuracy: 0.7459 - val_loss: 0.7075 - val_categorical_accuracy: 0.7472 - lr: 8.0000e-04 - 13s/epoch - 4ms/step
Epoch 68/70
3127/3127 - 13s - loss: 0.7104 - categorical_accuracy: 0.7465 - val_loss: 0.7107 - val_categorical_accuracy: 0.7454 - lr: 8.0000e-04 - 13s/epoch - 4ms/step
Epoch 69/70
3127/3127 - 13s - loss: 0.7079 - categorical_accuracy: 0.7475 - val_loss: 0.6998 - val_categorical_accuracy: 0.7504 - lr: 8.0000e-04 - 13s/epoch - 4ms/step
Epoch 70/70
3127/3127 - 13s - loss: 0.7084 - categorical_accuracy: 0.7471 - val_loss: 0.7069 - val_categorical_accuracy: 0.7486 - lr: 8.0000e-04 - 13s/epoch - 4ms/step
[92m
Saved model to: [0m trained_deepsets/deepsets_mean_16const
Loss vs epochs plot saved to trained_deepsets/deepsets_mean_16const.
Accuracy vs epochs plot saved to trained_deepsets/deepsets_mean_16const.
[92m
Plots done! [0m
